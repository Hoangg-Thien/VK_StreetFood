<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:VK.Mobile.ViewModels"
             xmlns:loc="clr-namespace:VK.Mobile.Services"
             x:Class="VK.Mobile.Views.SettingsPage"
             x:DataType="vm:SettingsViewModel"
             BackgroundColor="{StaticResource PageBackground}">

        <ScrollView>
                <VerticalStackLayout Spacing="0"
                                     Padding="0">

                        <!-- Language Section -->
                        <Frame Margin="16,16,16,0"
                               Padding="16"
                               BackgroundColor="{StaticResource CardBackground}"
                               BorderColor="Transparent"
                               CornerRadius="12">
                                <VerticalStackLayout Spacing="12">
                                        <Label Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsLanguageSection]}"
                                               FontSize="18"
                                               FontAttributes="Bold"
                                               TextColor="{StaticResource TextPrimary}"/>

                                        <Picker ItemsSource="{Binding LanguageDisplayNames}"
                                                SelectedIndex="{Binding SelectedLanguageDisplayIndex}"
                                                BackgroundColor="{StaticResource PageBackground}"
                                                TextColor="{StaticResource TextPrimary}"/>

                                        <Button Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsSaveLanguage]}"
                                                Command="{Binding SaveLanguageCommand}"
                                                BackgroundColor="{StaticResource Primary}"
                                                TextColor="White"
                                                HeightRequest="44"
                                                CornerRadius="8"/>
                                </VerticalStackLayout>
                        </Frame>

                        <!-- Notifications Section -->
                        <Frame Margin="16,16,16,0"
                               Padding="16"
                               BackgroundColor="{StaticResource CardBackground}"
                               BorderColor="Transparent"
                               CornerRadius="12">
                                <VerticalStackLayout Spacing="12">
                                        <Label Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsNotifications]}"
                                               FontSize="18"
                                               FontAttributes="Bold"
                                               TextColor="{StaticResource TextPrimary}"/>
                                        <Grid ColumnDefinitions="*,Auto">
                                                <Label Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsEnableNotifications]}"
                                                       VerticalOptions="Center"
                                                       TextColor="{StaticResource TextPrimary}"/>
                                                <Switch Grid.Column="1"
                                                        IsToggled="{Binding NotificationsEnabled}"
                                                        OnColor="{StaticResource Primary}"/>
                                        </Grid>
                                </VerticalStackLayout>
                        </Frame>

                        <!-- Audio Section -->
                        <Frame Margin="16,16,16,0"
                               Padding="16"
                               BackgroundColor="{StaticResource CardBackground}"
                               BorderColor="Transparent"
                               CornerRadius="12">
                                <VerticalStackLayout Spacing="12">
                                        <Label Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsAudio]}"
                                               FontSize="18"
                                               FontAttributes="Bold"
                                               TextColor="{StaticResource TextPrimary}"/>
                                        <Grid ColumnDefinitions="*,Auto">
                                                <Label Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsAutoPlayAudio]}"
                                                       VerticalOptions="Center"
                                                       TextColor="{StaticResource TextPrimary}"/>
                                                <Switch Grid.Column="1"
                                                        IsToggled="{Binding AutoPlayAudio}"
                                                        OnColor="{StaticResource Primary}"/>
                                        </Grid>
                                </VerticalStackLayout>
                        </Frame>

                        <!-- Location Section -->
                        <Frame Margin="16,16,16,0"
                               Padding="16"
                               BackgroundColor="{StaticResource CardBackground}"
                               BorderColor="Transparent"
                               CornerRadius="12">
                                <VerticalStackLayout Spacing="12">
                                        <Label Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsLocation]}"
                                               FontSize="18"
                                               FontAttributes="Bold"
                                               TextColor="{StaticResource TextPrimary}"/>

                                        <Label TextColor="{StaticResource TextSecondary}">
                                                <Label.FormattedText>
                                                        <FormattedString>
                                                                <Span Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsGeofenceLabel]}"/>
                                                                <Span Text=" "/>
                                                                <Span Text="{Binding GeofenceRadius, StringFormat='{0:F0}m'}"/>
                                                        </FormattedString>
                                                </Label.FormattedText>
                                        </Label>
                                        <Slider Minimum="20"
                                                Maximum="200"
                                                Value="{Binding GeofenceRadius}"
                                                MinimumTrackColor="{StaticResource Primary}"
                                                MaximumTrackColor="{StaticResource Border}"/>

                                        <Label TextColor="{StaticResource TextSecondary}">
                                                <Label.FormattedText>
                                                        <FormattedString>
                                                                <Span Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsLocationUpdateLabel]}"/>
                                                                <Span Text=" "/>
                                                                <Span Text="{Binding LocationUpdateInterval, StringFormat='{0}s'}"/>
                                                        </FormattedString>
                                                </Label.FormattedText>
                                        </Label>
                                        <Slider Minimum="1"
                                                Maximum="30"
                                                Value="{Binding LocationUpdateInterval}"
                                                MinimumTrackColor="{StaticResource Primary}"
                                                MaximumTrackColor="{StaticResource Border}"/>

                                        <Button Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsSaveLocation]}"
                                                Command="{Binding SaveGeofenceRadiusCommand}"
                                                BackgroundColor="{StaticResource Primary}"
                                                TextColor="White"
                                                HeightRequest="44"
                                                CornerRadius="8"/>
                                </VerticalStackLayout>
                        </Frame>

                        <!-- Storage Section -->
                        <Frame Margin="16,16,16,0"
                               Padding="16"
                               BackgroundColor="{StaticResource CardBackground}"
                               BorderColor="Transparent"
                               CornerRadius="12">
                                <VerticalStackLayout Spacing="12">
                                        <Label Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsStorage]}"
                                               FontSize="18"
                                               FontAttributes="Bold"
                                               TextColor="{StaticResource TextPrimary}"/>
                                        <Button Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsClearCache]}"
                                                Command="{Binding ClearCacheCommand}"
                                                BackgroundColor="{StaticResource Warning}"
                                                TextColor="White"
                                                HeightRequest="44"
                                                CornerRadius="8"/>
                                </VerticalStackLayout>
                        </Frame>

                        <!-- Account Section -->
                        <Frame Margin="16,16,16,16"
                               Padding="16"
                               BackgroundColor="{StaticResource CardBackground}"
                               BorderColor="Transparent"
                               CornerRadius="12">
                                <VerticalStackLayout Spacing="12">
                                        <Label Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsAccount]}"
                                               FontSize="18"
                                               FontAttributes="Bold"
                                               TextColor="{StaticResource TextPrimary}"/>
                                        <Button Text="{Binding Source={x:Static loc:LocalizationResourceManager.Instance}, Path=[SettingsLogout]}"
                                                Command="{Binding LogoutCommand}"
                                                BackgroundColor="{StaticResource Error}"
                                                TextColor="White"
                                                HeightRequest="44"
                                                CornerRadius="8"/>
                                </VerticalStackLayout>
                        </Frame>

                </VerticalStackLayout>
        </ScrollView>
</ContentPage>
