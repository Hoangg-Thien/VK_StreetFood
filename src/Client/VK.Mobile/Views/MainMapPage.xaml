<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:VK.Mobile.ViewModels"
             x:Class="VK.Mobile.Views.MainMapPage"
             x:DataType="vm:MainMapViewModel"
             Title="VK Street Food">

    <Grid RowDefinitions="Auto,*,Auto">

        <!-- Top Bar -->
        <Grid Grid.Row="0"
              Padding="10"
              BackgroundColor="#FF5722">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Label Grid.Column="0"
                   Text="VK Street Food Tour"
                   FontSize="20"
                   FontAttributes="Bold"
                   TextColor="White"
                   VerticalOptions="Center"/>

            <Picker Grid.Column="1"
                    Title="Language"
                    SelectedIndex="0"
                    TextColor="White"
                    TitleColor="White"
                    WidthRequest="120"
                    Margin="10,0"
                    SelectionChanged="OnLanguageChanged">
                <Picker.ItemsSource>
                    <x:Array Type="{x:Type x:String}">
                        <x:String>Tiếng Việt</x:String>
                        <x:String>English</x:String>
                        <x:String>한국어</x:String>
                    </x:Array>
                </Picker.ItemsSource>
            </Picker>

            <ImageButton Grid.Column="2"
                         Source="qr_scan.png"
                         BackgroundColor="Transparent"
                         WidthRequest="40"
                         HeightRequest="40"
                         Clicked="OnQRScanClicked"/>
        </Grid>

        <!-- Map Container -->
        <ContentView x:Name="MapContainer"
                     Grid.Row="1"/>

        <!-- Loading Indicator -->
        <ActivityIndicator Grid.Row="1"
                           IsRunning="{Binding IsLoading}"
                           IsVisible="{Binding IsLoading}"
                           Color="#FF5722"
                           VerticalOptions="Center"
                           HorizontalOptions="Center"/>

        <!-- Bottom Info Bar -->
        <Grid Grid.Row="2"
              Padding="10"
              BackgroundColor="White">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Image Grid.Column="0"
                   Source="location_icon.png"
                   WidthRequest="24"
                   HeightRequest="24"
                   VerticalOptions="Center"/>

            <StackLayout Grid.Column="1"
                         Spacing="2"
                         Margin="10,0">
                <Label Text="{Binding Pois.Count, StringFormat='POIs: {0}'}"
                       FontSize="14"
                       FontAttributes="Bold"/>
                <Label Text="{Binding NearbyPOIs.Count, StringFormat='Nearby: {0}'}"
                       FontSize="12"
                       TextColor="Gray"/>
            </StackLayout>

            <Frame Grid.Column="2"
                   Padding="8,4"
                   BackgroundColor="{Binding IsTracking, Converter={StaticResource BoolToColorConverter}}"
                   CornerRadius="12"
                   HasShadow="False">
                <Label Text="{Binding IsTracking, Converter={StaticResource BoolToTrackingTextConverter}}"
                       TextColor="White"
                       FontSize="12"/>
            </Frame>
        </Grid>

    </Grid>

</ContentPage>
